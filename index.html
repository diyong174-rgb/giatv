<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>PeanutFlix</title>

<!-- HLS.js (for .m3u8) -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<!-- Shaka Player (for .mpd / DASH) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.9.3/shaka-player.compiled.min.js"></script>

<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:Arial,Helvetica,sans-serif;background:#111;color:#fff}

  /* Mobile Layout */
  #iptv-sec {
    padding: 20px 16px 28px;
  }

  /* IPTV video area */
  #video-wrap {
    position:relative;
    width:100%;
    aspect-ratio:16/9;
    background:#000;
    border-radius:10px;
    overflow:hidden;
    margin-bottom: 20px;
  }
  #video-player {
    width:100%;
    height:100%;
  }

  /* Channel List */
  #iptv-list {
    max-height:calc(60vh - 10px); /* Adjust based on mobile screen size */
    overflow-y:auto;
  }
  .ch-item {
    padding:10px;
    margin-bottom:8px;
    background:#222;
    border:1px solid #ffffff1a;
    border-radius:8px;
    cursor:pointer;
    transition:background .2s;
  }
  .ch-item:hover {
    background:#2e2e2e;
  }
  .ch-title {
    font-size:14px;
    font-weight:600;
  }

  /* Buttons */
  .corner-btn {
    position:absolute;
    top:12px;
    padding:8px 12px;
    border:1px solid #fff6;
    background:rgba(0,0,0,.45);
    color:#fff;
    border-radius:8px;
    cursor:pointer;
    font-size:14px;
  }
  #open-drawer-btn {
    right:12px;
  }
  #save-to-mylist-btn {
    left:12px;
  }

  @media (max-width: 600px) {
    /* For mobile devices */
    #iptv-drawer {
      position:relative;
      top: 0;
      right: 0;
      background:transparent;
      height:auto;
      border:none;
      padding: 0;
    }
    #iptv-search {
      width:100%;
      padding:8px;
      margin-bottom:10px;
    }
  }
</style>
</head>
<body>

<header>
  <div class="logo">PeanutFlix</div>
  <nav>
    <ul>
      <li><a href="#" onclick="showHome();return false;">Home</a></li>
      <li><a href="#" onclick="showIPTV();return false;">Live TV</a></li>
      <li><a href="#" onclick="showRadio();return false;">Radio</a></li>
      <li><a href="#" onclick="showMyList();return false;">MyList</a></li>
      <li><a href="#" onclick="showChat();return false;">Chatroom</a></li>
    </ul>
  </nav>
</header>

<!-- HOME / WELCOME -->
<section id="home-sec" class="hero">
  <h1>Welcome to 3rsFlixTv</h1>
</section>

<!-- IPTV ONLY -->
<section id="iptv-sec" class="section hidden">
  <h2 style="margin-bottom:12px;">Live TV</h2>
  <div id="video-wrap">
    <button id="save-to-mylist-btn" class="corner-btn">☆ Save</button>
    <button id="open-drawer-btn" class="corner-btn">Channels ▸</button>
    <div id="video-player"></div>
  </div>
  <p style="opacity:.7;margin-top:10px;font-size:12px;">Tip: “Channels ▸” para ilabas ang drawer (auto-hide after 10s). “☆ Save” para i-add sa MyList.</p>

  <!-- Channel List Below Video -->
  <div id="iptv-list"></div>
</section>

<script>
  // Sample Channels
  const CHANNELS = {
    IPTV: [
      { name: 'KAPAMILYA', url: 'https://cdn-ue1-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-kapcha-dash-abscbnono/index.mpd', type: 'mpd', logo: '' },
      { name: '3RsTV', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210631/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: 'https://i.ibb.co/nN0VGRY8/Chat-GPT-Image-Oct-4-2025-05-05-12-AM-1.png' },
      { name: '3rsSinePinoy', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210267/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: 'https://i.ibb.co/2Y83j9Dx/3rs-Sine-Pinoy.png' },
      { name: 'STAR TELEVISION', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210731/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: 'https://i.imgur.com/tSwdUjj.png' },
      { name: 'CinePlex Asia', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210632/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: 'https://i.imgur.com/tSwdUjj.png' },
      { name: 'JUZT-TV BOX', url: 'https://live20.bozztv.com/giatvplayout7/giatv-210639/tracks-v1a1/mono.ts.m3u8', type: 'hls', logo: 'https://juzt-tv.vercel.app/your-logo.png' }
    ]
  };

  let hls = null;
  let shakaPlayer = null;

  // Render IPTV Channel List
  function renderIPTVList() {
    const list = document.getElementById('iptv-list');
    list.innerHTML = ''; // Clear existing list
    CHANNELS.IPTV.forEach((ch) => {
      const item = document.createElement('div');
      item.className = 'ch-item';
      item.innerHTML = `
        <div class="ch-title">${ch.name}</div>
      `;
      item.onclick = () => playIPTV(ch);
      list.appendChild(item);
    });
  }

  // Play IPTV Channel
  function playIPTV(channel) {
    const videoWrap = document.getElementById('video-player');
    const video = document.createElement('video');
    video.setAttribute('playsinline', '');
    video.setAttribute('controls', '');
    video.style.width = '100%';
    video.style.height = '100%';
    videoWrap.innerHTML = ''; // Clear previous video
    videoWrap.appendChild(video);

    if (channel.type === 'hls') {
      if (Hls.isSupported()) {
        hls = new Hls();
        hls.loadSource(channel.url);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, () => {
          video.play().catch(() => {});
        });
      } else {
        video.src = channel.url;
        video.play().catch(() => {});
      }
    } else if (channel.type === 'mpd') {
      shaka.polyfill.installAll();
      if (!shaka.Player.isBrowserSupported()) {
        alert('Shaka: browser not supported.');
        return;
      }
      shakaPlayer = new shaka.Player(video);
      shakaPlayer.load(channel.url).then(() => {
        video.play().catch(() => {});
      });
    } else {
      alert('Unsupported stream type');
    }
  }

  // Initialize
  document.addEventListener('DOMContentLoaded', () => {
    showHome();
    renderIPTVList();
  });

  // Show Home
  function showHome() {
    hideAll();
    document.getElementById('home-sec').classList.remove('hidden');
  }

  // Hide All Sections
  function hideAll() {
    document.getElementById('home-sec').classList.add('hidden');
    document.getElementById('iptv-sec').classList.add('hidden');
  }

  // Show IPTV
  function showIPTV() {
    hideAll();
    document.getElementById('iptv-sec').classList.remove('hidden');
    renderIPTVList();
  }
</script>

</body>
</html>
